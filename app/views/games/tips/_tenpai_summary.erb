<% player = @game.user_player %>
<% yaku_map = player.yaku_map_by_waiting_wining_tile %>

<div class="space-y-4 text-xl">
  <div class="flex items-center justify-between rounded-lg border border-emerald-700/40 bg-slate-900/90 px-4 py-3">
    <p class="font-semibold tracking-[0.35em] text-emerald-300">向聴数</p>
    <p class="font-semibold text-emerald-100"><%= player.shanten %>(聴牌)</p>
  </div>
  <div class="rounded-lg border border-emerald-700/40 bg-slate-900/90 px-4 py-3">
    <p class="font-semibold tracking-[0.35em] text-emerald-300">待ち牌・確定役</p>
    <% if yaku_map.present? %>
      <div class="mt-3 space-y-3 w-full">
        <% yaku_map.each do |tile, yaku_list| %>
          <div class="flex flex-wrap items-center justify-between gap-4 rounded-xl border border-emerald-500/30 bg-emerald-900/30 px-4 py-3 text-sm text-emerald-100">
            <%= image_tag("tiles/#{tile.suit}_#{tile.number}.gif", class: 'w-10 drop-shadow') %>
            <div class="ml-auto text-right">
              <% if yaku_list.present? %>
                <p class="text-xs uppercase tracking-[0.3em] text-emerald-300">確定役</p>
                <ul class="mt-1 space-y-0.5 text-xs text-emerald-100 text-right">
                  <% yaku_list.each do |yaku| %>
                    <li><%= yaku[:name] %></li>
                  <% end %>
                </ul>
              <% else %>
                <p class="text-xs text-emerald-200/60">確定役はありません。</p>
              <% end %>
            </div>
          </div>
        <% end %>
      </div>
    <% else %>
      <p class="text-sm text-emerald-200/70">現在、待ち牌はありません。</p>
    <% end %>
  </div>
</div>
